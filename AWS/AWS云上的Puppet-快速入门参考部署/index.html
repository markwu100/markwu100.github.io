<!DOCTYPE HTML>
<html lang="null">
<head><meta name="generator" content="Hexo 3.8.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="Cloud Service一站通">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://blog.ozairs.com">
    <!--SEO-->

    <meta name="keywords" content="AWS">


    <meta name="description" content="本快速入门参考部署指南讨论在 Amazon Web Services (AWS) 云中部署和测试 Puppet Master 和 Puppet 代理所需的步骤。它还提供了用于查看和启动 AWS ...">



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">

    <!--Title-->


<title>AWS云上的Puppet:快速入门参考部署 | Cloud Service一站通</title>


    <link rel="alternate" href="/atom.xml" title="Cloud Service一站通" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
		<script type="text/javascript">
			var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
		</script>
	</div>





	<script>
		(function(i, s, o, g, r, a, m) {
		    i['GoogleAnalyticsObject'] = r;
		    i[r] = i[r] || function() {
		        (i[r].q = i[r].q || []).push(arguments)
		    }, i[r].l = 1 * new Date();
		    a = s.createElement(o),
		    m = s.getElementsByTagName(o)[0];
		    a.async = 1;
		    a.src = g;
		    m.parentNode.insertBefore(a, m)
		})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
		ga('create', 'UA-136105852-1', 'auto');
		ga('send', 'pageview');
	</script>


    

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header">
    <div class="main-header-box">
        <a class="header-avatar" href="/" title="Mark Wu">
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                 <img src="/img/branding.png" alt="Snippet 博客主题" class="img-responsive center-block">
            
    	</div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://blog.ozairs.com">Cloud Service一站通</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>Main</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/AWS"><i class="fa "></i>AWS</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Ansible"><i class="fa "></i>Ansible</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Cloud-Service"><i class="fa "></i>Cloud Service</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Security"><i class="fa "></i>Security</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/DevOps"><i class="fa "></i>DevOps</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Docker"><i class="fa "></i>Docker</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Jenkins"><i class="fa "></i>Jenkins</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Kubernetes"><i class="fa "></i>Kubernetes</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Python"><i class="fa "></i>Python</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Terraform"><i class="fa "></i>Terraform</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives/"><i class="fa "></i>Archives</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="https://156709406.gitbook.io/markwu100/"><i class="fa "></i>《Go Terraform》Chinese Version</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="AWS云上的Puppet:快速入门参考部署">
            
	            AWS云上的Puppet:快速入门参考部署
            
        </h1>
        <div class="post-meta">
    
        <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
            <a class="category-link" href="/categories/AWS/">AWS</a>
        </span>
    

    
        <span class="fa-wrap">
            <i class="fa fa-tags"></i>
            <span class="tags-meta">
                
                    <a class="tag-link" href="/tags/AWS/">AWS</a>
                
            </span>
        </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/03/14</span>
        </span>
        
    
</div>
            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>375</strong>天之前发表，文中内容可能已经过时。
            </p>
        
    </div>
    
    <div class="post-body post-content">
        <p>本快速入门参考部署指南讨论在 Amazon Web Services (AWS) 云中部署和测试 Puppet Master 和 Puppet 代理所需的步骤。它还提供了用于查看和启动 <a href="https://aws.amazon.com/cloudformation/" target="_blank" rel="noopener">AWS CloudFormation</a> 模板（可自动进行部署）的链接，以及有关如何配置充当 Puppet 代理的 Amazon Elastic Compute Cloud (Amazon EC2) 实例的演练。</p>
<p>本指南面向计划在 AWS 云上实施或扩展 Puppet 工作负载的 IT 基础设施架构师、管理员和 DevOps 专家。</p>
<ul>
<li>如果您拥有 AWS 账户且已熟悉 AWS 和 Puppet，可以<a href="https://fwd.aws/YBD5Y" target="_blank" rel="noopener">启动快速入门</a>以构建<a href="https://docs.aws.amazon.com/zh_cn/quickstart/latest/puppet/architecture.html#fig1" target="_blank" rel="noopener">图 1</a> 所示的架构。完成部署需要约 20 分钟。如果您是刚刚接触 AWS 或 Puppet，请查看实施详情，然后按照本指南后面部分提供的<a href="https://docs.aws.amazon.com/zh_cn/quickstart/latest/puppet/deployment.html" target="_blank" rel="noopener">分步说明</a>来启动快速入门。</li>
</ul>
<p>  <a href="https://fwd.aws/YBD5Y" target="_blank" rel="noopener">https://fwd.aws/YBD5Y</a></p>
<ul>
<li>如果您想更深一步地了解相关信息，则可以<a href="https://fwd.aws/pkzpq" target="_blank" rel="noopener">查看模板</a>以了解自动执行此部署的 AWS CloudFormation 脚本。默认情况下，默认配置将部署三个使用 t2.medium 实例类型的服务器，但您也可以按需自定义模板。</li>
</ul>
<p>  <a href="https://fwd.aws/pkzpq" target="_blank" rel="noopener">https://fwd.aws/pkzpq</a></p>
<p>注意</p>
<p>运行本快速入门参考部署时，您需要支付所用的所有 AWS 服务的相关费用。价格可能会发生变化。有关完整详细信息，请参阅<a href="https://docs.aws.amazon.com/zh_cn/quickstart/latest/puppet/overview.html#cost" target="_blank" rel="noopener">成本和许可证</a>部分以及您所使用 AWS 服务的定价页面。</p>
<h1 id="步骤-1-准备-AWS-账户"><a href="#步骤-1-准备-AWS-账户" class="headerlink" title="步骤 1.准备 AWS 账户"></a>步骤 1.准备 AWS 账户</h1><ol>
<li><p>如果您还没有 AWS 账户，请按照屏幕说明在 <a href="https://aws.amazon.com/" target="_blank" rel="noopener">https://aws.amazon.com</a> 上创建一个。 作为注册流程的一部分，您会接到一个电话，并且需要通过手机键盘输入 PIN 码。</p>
</li>
<li><p>使用导航栏中的区域选择器选择要在 AWS 上将 Puppet 部署到的 AWS 区域。</p>
<p>Amazon EC2 位置由<em>区域</em> 和<em>可用区</em> 构成。区域分散存在，位于独立的地理区域。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/1.png" alt="">          </p>
<p><strong>图 2：选择 AWS 区域</strong></p>
<p>提示</p>
<p>考虑选择最接近数据中心或企业网络的区域，以减少运行于 AWS 的系统与企业网络上的系统和用户之间的网络延迟。</p>
</li>
<li><p>在首选区域中创建一个<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html" target="_blank" rel="noopener">密钥对</a>。为此，在 Amazon EC2 控制台的导航窗格中，依次选择 <strong>Key Pairs (密钥对)</strong>、<strong>Create Key Pair (创建密钥对)</strong>，键入名称，然后选择 <strong>Create (创建)</strong>。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/2.png" alt=""></p>
<p><strong>图 3：创建密钥对</strong></p>
<p>Amazon EC2 使用公有密钥密码术来加密和解密登录信息。要登录实例，必须创建密钥对。对于 Windows 实例，我们使用密钥对通过 Amazon EC2 控制台获取管理员密码，然后使用远程桌面协议 (RDP) 登录，如 <em>Amazon Elastic Compute Cloud 用户指南</em> 中的<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html#having-ec2-create-your-key-pair" target="_blank" rel="noopener">分步说明</a>所述。在 Linux 上，我们使用密钥对来对 SSH 登录进行身份验证。</p>
</li>
<li><p>如有必要，可针对 <strong>t2.medium</strong> 实例类型<a href="https://console.aws.amazon.com/support/home#/case/create?issueType=service-limit-increase%26;limitType=service-code-" target="_blank" rel="noopener">请求提高服务限制</a>。为此，在 AWS Support Center 中，选择 <strong>Create Case</strong>，<strong>Service Limit Increase</strong>，<strong>EC2 instances</strong>，然后填写限制提高表中的字段。此实例类型的当前默认限制为 20 个实例。</p>
<p>如果您已有使用此实例类型的现有部署，并且可能会超过此参考部署的默认限制，则可能需要请求提高限制。新服务限制可能需要几天才能生效。有关更多信息，请参阅 AWS 文档中的 <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-resource-limits.html" target="_blank" rel="noopener">Amazon EC2 服务限制</a>。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/3.png" alt=""></p>
<p><strong>图 4：请求提高服务限制</strong></p>
</li>
</ol>
<h1 id="步驟-2-启动-Puppet-堆栈"><a href="#步驟-2-启动-Puppet-堆栈" class="headerlink" title="步驟 2.启动 Puppet 堆栈"></a>步驟 2.启动 Puppet 堆栈</h1><p>此快速入门附带的自动化 AWS CloudFormation 模板将 Puppet 部署到 VPC 中。在启动堆栈之前，请确保您已完成前面的步骤。</p>
<ol>
<li><p>在您的 AWS 账户中启动 AWS CloudFormation 模板。<a href="https://fwd.aws/YBD5Y" target="_blank" rel="noopener">https://fwd.aws/YBD5Y</a></p>
<p>默认情况下，模板在 美国西部（俄勒冈） 区域中启动。您可以使用导航栏中的区域选择器来更改区域。</p>
<p>创建此堆栈需要大约 20 分钟时间。</p>
<p>注意</p>
<p>运行本快速入门参考部署时，您需要支付所用的 AWS 服务的费用。使用本快速入门不收取任何额外费用。有关完整详细信息，请参阅您将使用的每项 AWS 服务的定价页。</p>
</li>
<li><p>在 <strong>Select Template (选择模板)</strong> 页面上，保留 AWS CloudFormation 模板的默认 URL，然后选择 <strong>Next (下一步)</strong>。</p>
</li>
<li><p>在 <strong>Specify Details</strong> 页面上，查看模板的参数。下表描述了这些选项。</p>
<p>为 <em>KeyPairName</em> 参数提供值。此参数需要您进行输入。对于所有其他参数，模板提供可以自定义的默认设置。</p>
<p><em>安全配置：</em></p>
</li>
</ol>
<table>
<thead>
<tr>
<th>参数标签</th>
<th>参数名称</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>选择一个密钥对</strong></td>
<td><strong>KeyPairName</strong></td>
<td><em>需要输入</em></td>
<td>公有/私有密钥对，使您能够在实例启动后安全地与它连接。创建 AWS 账户时，这是您在首选区域中创建的密钥对。</td>
</tr>
<tr>
<td><strong>用于远程访问的源 IP</strong></td>
<td><strong>RemoteAdminCIDR</strong></td>
<td><em>需要输入</em></td>
<td>用于 SSH 和 RDP 访问的 CIDR 块或 IP 地址 (例如，1.1.1.1/32)。</td>
</tr>
</tbody>
</table>
<p>   <em>AWS 快速入门配置：</em></p>
<table>
<thead>
<tr>
<th>参数标签</th>
<th>参数名称</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>快速入门 S3 存储桶名称</strong></td>
<td>QSS3BucketName</td>
<td>aws-quickstart</td>
<td>安装快速入门模板和脚本的 S3 存储桶。如果您决定自定义或扩展快速入门以供您自己使用，请使用此参数来指定您为快速入门资产的副本创建的 S3 存储桶名称。存储桶名称可以包含数字、小写字母、大写字母和连字符，但不得以连字符开头或结尾。</td>
</tr>
<tr>
<td><strong>快速入门 S3 键前缀</strong></td>
<td>QSS3KeyPrefix</td>
<td>quickstart-puppet/</td>
<td><a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMetadata.html" target="_blank" rel="noopener">S3 键名称前缀</a>，用于模拟快速入门资产的副本的文件夹（如果您决定自定义或扩展快速入门以供您自己使用）。此前缀可以包含数字、小写字母、大写字母、连字符和正斜杠。</td>
</tr>
</tbody>
</table>
<p>   <em>网络配置:</em></p>
<table>
<thead>
<tr>
<th>参数标签</th>
<th>参数名称</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>VPC 的 CIDR 范围</strong></td>
<td><strong>VPCCIDR</strong></td>
<td>10.0.0.0/16</td>
<td>Amazon VPC 的 CIDR 块。</td>
</tr>
<tr>
<td><strong>VPC 中的子网的 CIDR 范围</strong></td>
<td><strong>SubnetCIDR</strong></td>
<td>10.0.0.0/19</td>
<td>子网的 CIDR 块。</td>
</tr>
<tr>
<td><strong>Puppet Master 的 IP 地址</strong></td>
<td><strong>PuppetMasterIP</strong></td>
<td>10.0.0.10</td>
<td>Puppet Master 部署到的实例的 IP 地址。</td>
</tr>
<tr>
<td><strong>Linux Puppet 代理的 IP 地址</strong></td>
<td><strong>PuppetAgentLinuxIP</strong></td>
<td>10.0.0.11</td>
<td>Linux Puppet 代理部署到的实例的 IP 地址。</td>
</tr>
<tr>
<td><strong>Windows Puppet 代理的 IP 地址</strong></td>
<td><strong>PuppetAgentWindowsIP</strong></td>
<td>10.0.0.12</td>
<td>Windows Puppet 代理部署到的实例的 IP 地址。</td>
</tr>
</tbody>
</table>
<ol start="4">
<li><p>在 <strong>Options (选项)</strong> 页面上，您可以为堆栈中的资源<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-resource-tags.html" target="_blank" rel="noopener">指定标签</a>（键-值对）并<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-add-tags.html" target="_blank" rel="noopener">设置其他选项</a>。在完成此操作后，选择 <strong>Next (下一步)</strong>。</p>
</li>
<li><p>在 <strong>Review</strong> 页面上，查看并确认模板设置。选择 <strong>Capabilities</strong> 下的复选框，以确认模板将创建 IAM 资源。</p>
</li>
<li><p>选择 <strong>Create</strong> 以部署堆栈。</p>
</li>
<li><p>监控堆栈的状态。当状态显示 <strong>CREATE_COMPLETE</strong> 时，表示 Puppet 集群已准备就绪。</p>
</li>
</ol>
<h1 id="步驟-3-配置-Puppet-代理"><a href="#步驟-3-配置-Puppet-代理" class="headerlink" title="步驟 3.配置 Puppet 代理"></a>步驟 3.配置 Puppet 代理</h1><p>您可以按照本部分中的说明进行操作，来测试 AWS 上的 Puppet 设置。我们将查看 Puppet 代理的模块清单，应用配置并验证是否已成功应用配置。</p>
<h2 id="审查模块和清单"><a href="#审查模块和清单" class="headerlink" title="审查模块和清单"></a>审查模块和清单</h2><p>可通过多种方法将配置应用于代理节点（请参阅 <a href="https://puppet.com/docs" target="_blank" rel="noopener">Puppet 文档</a>）。此快速入门对每个 Linux 和 Windows 节点使用模块，并在引导启动阶段将这些模块从 Amazon S3 下载到主节点。</p>
<p>Puppet 程序称作<em>清单</em>，它们是使用 Puppet 代码开发的。（有关 Puppet 语言的信息，请参阅 <a href="https://puppet.com/docs/puppet/5.5/lang_summary.html" target="_blank" rel="noopener">Puppet 文档</a>。） 主清单的名称为 <strong>site.pp</strong>，并且位于清单文件夹中的主节点上。图 5 显示此快速入门中的主节点所使用的 site.pp 清单。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/4.png" alt=""></p>
<p><strong>图 5：主清单</strong></p>
<p>此清单包含三个节点声明：</p>
<ul>
<li><strong>第 1 行</strong> – 定义默认情况下可应用于任何系统的节点块。我们不执行任何常见配置，因此大括号内没有代码。</li>
<li><strong>第 3 行</strong> – 为名为 <em>linuxagent.example.com</em> 的代理定义节点块。这是由快速入门启动的 Ubuntu 代理。我们引用名为 <code>lampserver</code> 的模块中的类，而不是将资源定义置于此节点块中。使用类是减少代码重复的绝佳方式。在这种情况下，当 Linux 代理应用其配置时，它将使用 <code>lampserver</code> 类中的代码来定义系统的状态。</li>
<li><strong>第 7 行</strong> – 为名为 <em>windowsagent.example.com</em> 的代理定义节点块。这是由快速入门启动的 Windows Server 2012 R2 代理。我们引用名为 <code>iisserver</code> 的模块中的类，而不是将资源定义置于此节点块中。当 Windows 代理应用其配置时，它将使用 <code>iisserver</code> 类中的代码来定义系统的状态。</li>
</ul>
<p>接下来，我们来看看 <code>lampserver</code> 和 <code>iisserver</code> 类以了解其功能。</p>
<p>在名为 <code>lampserver</code> 的模块中定义 <code>lampserver</code> 类。模块的清单文件名为 <strong>init.pp</strong>，并且位于主节点上的 <strong>/etc/puppet/modules/lampserver/manifests</strong> 中。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/5.png" alt=""></p>
<p><strong>图 6：lampserver 类</strong></p>
<p>请注意以下与图 6 中显示的 <code>lampserver</code> 代码有关的内容：</p>
<ul>
<li><strong>第 1 行</strong> – 这是主清单文件中引用的 <code>lampserver</code> 的类定义。</li>
<li><strong>第 2 行</strong> – <code>exec</code> 关键字定义资源声明。您可使用资源来描述系统的所需状态。在这里，我们使用 <code>exec</code> 资源来对节点执行 <code>apt-update</code> 命令。</li>
<li><strong>第 6 行</strong> – 包资源用于在节点上安装 Apache 2。请注意，<code>require</code> 语句可确保 <code>apt-update</code> 在能够安装此资源之前已运行。</li>
<li><strong>第 11 行</strong> – <code>service</code> 资源确保 Apache 2 服务正在运行。</li>
<li><strong>第 15 行</strong> – <code>package</code> 资源确保一旦成功执行 <code>apt-update</code>，就立即安装 MySQL 服务器。</li>
<li><strong>第 20 行</strong> – <code>service</code> 资源确保 MySQL 正在运行。</li>
<li><strong>第 24 行</strong> – <code>package</code> 资源确保一旦成功执行 <code>apt-update</code>，就立即安装 PHP 5。</li>
<li><strong>第 29 行</strong> – <code>file</code> 资源确保在默认 <strong>apache</strong> 根目录中创建名为 <strong>info.php</strong> 的新文件。这需要安装 Apache 2。PHP 代码将添加到文件内容中，以便在用户通过 Web 浏览器访问网站时提供有关 Web 服务器的信息性页面。</li>
</ul>
<p>在名为 <code>iisserver</code> 的模块中定义 <code>iisserver</code> 类。模块的清单文件名为 <strong>init.pp</strong>，并且位于主节点上的 <strong>/etc/puppet/modules/iisserver/manifests</strong> 中。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/6.png" alt=""></p>
<p><strong>图 7：iisserver 类</strong></p>
<p>请注意以下与图 7 中显示的 <code>iisserver</code> 代码有关的内容：</p>
<ul>
<li><strong>第 1 行</strong> – 这是主清单文件中引用的 <code>iisserver</code> 的类定义。</li>
<li><strong>第 15 行</strong> – <code>windowsfeature</code> 资源利用 Windows PowerShell 确保安装 IIS 和 ASP.NET 的所有必需组件。</li>
<li><strong>第 19 行</strong> – <code>windowsfeature</code> 资源安装用于 IIS 管理的管理工具。</li>
<li><strong>第 25 行</strong> – <code>file</code> 资源确保 Web 服务器根目录中有一个名为 <strong>info.aspx</strong> 的信息性 ASP.NET 网页。此网页的内容因空间限制而被截断 (图 7 中所示)，但它包含一个提供服务器相关信息的页面指令，就像 Linux 节点上的 <strong>info.php</strong> 一样。</li>
</ul>
<p>除了创建您自己的模块之外，您还可以直接使用清单，或者利用 Puppet Forge 中预先存在的模块。有关编写模块和清单的详细信息，请参阅 Puppet 网站上的<a href="https://docs.puppet.com/puppet/4.3/modules_fundamentals.html" target="_blank" rel="noopener">模块基础知识</a>和<a href="https://puppet.com/support-services/training" target="_blank" rel="noopener">培训课程</a>。</p>
<h2 id="连接到-Puppet-代理"><a href="#连接到-Puppet-代理" class="headerlink" title="连接到 Puppet 代理"></a>连接到 Puppet 代理</h2><p>现在，您已了解示例模块的用途，已准备好远程连接到您的代理。</p>
<h3 id="Linux-代理"><a href="#Linux-代理" class="headerlink" title="Linux 代理"></a>Linux 代理</h3><p>您将需要使用 SSH 从 VPC 外部连接到您的 Linux 代理。在 Amazon EC2 控制台中，选择标记有 <strong>LinuxAgent</strong> 的 EC2 实例，如图 8 所示。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/7.png" alt=""></p>
<p><strong>图 8：选择 LinuxAgent 实例</strong></p>
<p>在公有 DNS 名称中检索 <strong>LinuxAgent</strong>，按照<em>适用于 Linux 实例的 Amazon EC2 用户指南</em>中的<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EC2_GetStarted.html#ec2-connect-to-instance-linux" target="_blank" rel="noopener">说明</a>操作，以将 SSH 客户端连接到实例。您将需要可用的密钥对才能建立远程 SSH 连接。</p>
<h3 id="Windows-代理"><a href="#Windows-代理" class="headerlink" title="Windows 代理"></a>Windows 代理</h3><p>您可以使用 RDP 通过 Internet 连接到 Windows 代理。在 Amazon EC2 控制台中，选择标记有 <strong>WindowsAgent</strong>的 EC2 实例，如图 9 所示。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/8.png" alt=""></p>
<p><strong>图 9：选择 WindowsAgent 实例</strong></p>
<p>在公有 DNS 名称中检索 <strong>WindowsAgent</strong>，按照<em>适用于 Microsoft Windows 实例的 Amazon EC2 用户指南</em>中的<a href="https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/connecting_to_windows_instance.html" target="_blank" rel="noopener">说明</a>操作，以建立连接。您将需要可用的密钥对才能解密 Windows 管理员密码并建立远程连接。</p>
<h2 id="应用配置"><a href="#应用配置" class="headerlink" title="应用配置"></a>应用配置</h2><p>在此部分中，您将应用节点配置并验证一切是否已配置成功。</p>
<h3 id="Linux-代理-1"><a href="#Linux-代理-1" class="headerlink" title="Linux 代理"></a>Linux 代理</h3><p>在通过 SSH 连接到 Linux 代理后，请运行以下命令以应用 <code>lampserver</code> 模块中的配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo puppet agent --test</span><br></pre></td></tr></table></figure>
<p>您应看到与图 10 中的内容类似的输出，这指示已成功应用配置。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/9.png" alt=""></p>
<p><strong>图 10：Linux Puppet 代理输出</strong></p>
<p>接下来，打开 Web 浏览器并导航到 info.php 页面。您将需要使用 <strong>LinuxAgent</strong> EC2 实例的公有 DNS 名称 — 例如，http://&lt;<em>public DNS name</em>&gt;/info.php。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/10.png" alt=""></p>
<p><strong>图 11：测试 Apache Web 服务器</strong></p>
<p>您应看到与图 11 中所示内容类似的 PHP 版本页面。这表示您已将配置成功应用于您的 Linux 代理。</p>
<h3 id="Windows-代理-1"><a href="#Windows-代理-1" class="headerlink" title="Windows 代理"></a>Windows 代理</h3><p>在通过 RDP 连接到您的 Windows 代理后，在“Start”屏幕上查找 <strong>Start Command Prompt with Puppet</strong> 快捷方式。打开快捷方式的上下文 (右键单击) 菜单，然后选择 <strong>Run as administrator</strong>。运行以下命令以应用 <code>iisserver</code> 模块中的配置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">puppet_interactive.bat</span><br></pre></td></tr></table></figure>
<p>您应看到与图 12 中的内容类似的输出，这指示已成功应用配置。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/12.png" alt=""></p>
<p><strong>图 12：Windows Puppet 代理输出</strong></p>
<p>最后，打开 Web 浏览器并导航到 info.aspx 页面。您将需要使用 <strong>WindowsAgent</strong> EC2 实例的公有 DNS 名称 — 例如，http://&lt;<em>public DNS name</em>&gt;/info.aspx。</p>
<p><img src="/AWS/AWS云上的Puppet-快速入门参考部署/13.png" alt=""></p>
<p><strong>图 13：测试 IIS Web 服务器</strong></p>
<p>您应看到与图 13 中所示内容类似的 IIS 版本页面。这表示您已将配置成功应用于您的 Windows 代理。</p>

    </div>
    
        <div class="reward" ontouchstart="">
    <div class="reward-wrap">赏
        <div class="reward-box">
            
            
                <span class="reward-type">
                    <img class="wechat" src="/img/wechatpay.jpg"><b>微信打赏</b>
                </span>
            
        </div>
    </div>
    <p class="reward-tip">坚持原创分享，您的支持将鼓励我继续创作！</p>
</div>


    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">Mark</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/Ansible/Ansible进阶手册/" class="pre-post btn btn-default" title="Ansible进阶手册">
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">Ansible进阶手册</span>
        </a>
    
    
        <a href="/DevOps/2019年DevOps必备面试问题/" class="next-post btn btn-default" title="2019年DevOps必备面试问题">
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">2019年DevOps必备面试问题</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
    <div id="vcomments" class="valine"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: 'undefined',
            appKey: 'undefined',
            placeholder: '说点什么吧',
            notify: false,
            verify: false,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'null'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">Table of Contents</h3>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#步骤-1-准备-AWS-账户"><span class="toc-text">步骤 1.准备 AWS 账户</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#步驟-2-启动-Puppet-堆栈"><span class="toc-text">步驟 2.启动 Puppet 堆栈</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#步驟-3-配置-Puppet-代理"><span class="toc-text">步驟 3.配置 Puppet 代理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#审查模块和清单"><span class="toc-text">审查模块和清单</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#连接到-Puppet-代理"><span class="toc-text">连接到 Puppet 代理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-代理"><span class="toc-text">Linux 代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-代理"><span class="toc-text">Windows 代理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#应用配置"><span class="toc-text">应用配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-代理-1"><span class="toc-text">Linux 代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-代理-1"><span class="toc-text">Windows 代理</span></a></li></ol></li></ol></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2017
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>







<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>